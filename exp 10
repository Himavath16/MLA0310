import numpy as np


num_states = 3     
num_actions = 3    
episodes = 500
alpha = 0.01      
gamma = 0.99       

theta = np.random.randn(num_states, num_actions)

def softmax(x):
    exp_x = np.exp(x - np.max(x))
    return exp_x / np.sum(exp_x)

def choose_action(state):
    probs = softmax(theta[state])
    return np.random.choice(num_actions, p=probs)

def get_reward(state, action):
    if state == 2 and action == 2:   
        return 5
    if state == 0 and action == 2:  
        return -5
    if action == 1:                 
        return 1
    return 0

for episode in range(episodes):
    state = np.random.choice(num_states)
    action = choose_action(state)
    reward = get_reward(state, action)

    probs = softmax(theta[state])
    grad = -probs
    grad[action] += 1

  
    theta[state] += alpha * reward * grad


actions = ["Sell", "Hold", "Buy"]
states = ["Bearish", "Neutral", "Bullish"]

print("Optimal Investment Policy:\n")
for s in range(num_states):
    best_action = actions[np.argmax(softmax(theta[s]))]
    print(f"Market: {states[s]} â†’ Action: {best_action}")
